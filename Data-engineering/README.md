Есть таблица с данными test_data_20200113.csv, которая инкрементально ежедневно наполняется: ежедневно создаются новые строки в таблице для старых и новых id.
Необходимо написать SQL-процедуру на PostgreSQL, которая позволит преобразовать хранение данных в интервалы дат (date_from / date_to).

Было:
id | rev | date_from | date_to
--- | --- | --- | ---
1 | 2 | 01.01.2020 | 01.01.2020
1 | 4 | 01.01.2020 | 03.01.2020
1 | 3 | 01.01.2020 | 05.01.2020
2 | 2 | 01.01.2020 | 01.01.2020 
2 | 5 | 01.01.2020 | 07.01.2020
3 | 6 | 01.01.2020 | 01.01.2020
3 | 2 | 01.01.2020 | 11.01.2020

Стало:
id | rev | date_from | date_to
--- | --- | --- | ---
1 | 2 | 01.01.2020 | 03.01.2020
1 | 4 | 03.01.2020 | 05.01.2020
1 | 3 | 05.01.2020 | 31.12.9999
2 | 2 | 01.01.2020 | 07.01.2020
2 | 5 | 07.01.2020 | 31.12.9999
3 | 6 | 01.01.2020 | 11.01.2020
3 | 2 | 11.01.2020 | 31.12.9999

Результат – 2 скрипта в формате .sql (для PostgreSQL): 
1) DDL необходимой таблицы + скрипт для первичного наполнения таблицы с данными в нужном формате;
2) Процедура, которая обновляет/добавляет строки в таблицу при появлении новых записей.
